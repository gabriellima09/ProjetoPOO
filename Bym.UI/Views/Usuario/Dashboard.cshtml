@model Bym.UI.Models.Domain.Dashboard
@{
    ViewBag.Title = "Dashbord";
}

<h2>Dashboard</h2>

<hr />

<div class="btn-group">
    @using (Html.BeginForm("Report", "Usuario", FormMethod.Post))
    {
        <button class="btn btn-primary" type="submit">
            <span class="glyphicon glyphicon-file"></span>
            <span>Gerar Relatório </span>
        </button>

        @Html.HiddenFor(x => x.SalaMaiorCapacidade)
        @Html.HiddenFor(x => x.TotalReservas)
        @Html.HiddenFor(x => x.TotalSalas)
        @Html.HiddenFor(x => x.ValorArrecadado)

        @Html.HiddenFor(x => x.UltimaSalaCadastrada.CapacidadeMaxima)
        @Html.HiddenFor(x => x.UltimaSalaCadastrada.Descricao)
        @Html.HiddenFor(x => x.UltimaSalaCadastrada.Endereco.Complemento)
        @Html.HiddenFor(x => x.UltimaSalaCadastrada.Endereco.Numero)
        @Html.HiddenFor(x => x.UltimaSalaCadastrada.Endereco.Logradouro)
        @Html.HiddenFor(x => x.UltimaSalaCadastrada.Nome)
        @Html.HiddenFor(x => x.UltimaSalaCadastrada.ValorHora)

        @Html.HiddenFor(x => x.UltimaReserva.DataHora)
        @Html.HiddenFor(x => x.UltimaReserva.HorasReservadas)
        @Html.HiddenFor(x => x.UltimaReserva.Usuario.Login)
        @Html.HiddenFor(x => x.UltimaReserva.Sala.CapacidadeMaxima)
        @Html.HiddenFor(x => x.UltimaReserva.Sala.Descricao)
        @Html.HiddenFor(x => x.UltimaReserva.Sala.Descricao)
        @Html.HiddenFor(x => x.UltimaReserva.Sala.Endereco.Complemento)
        @Html.HiddenFor(x => x.UltimaReserva.Sala.Endereco.Numero)
        @Html.HiddenFor(x => x.UltimaReserva.Sala.Endereco.Logradouro)
        @Html.HiddenFor(x => x.UltimaReserva.Sala.Nome)
        @Html.HiddenFor(x => x.UltimaReserva.Sala.ValorHora)
    }
</div>

<hr />

<div class="panel panel-body panel-default">
    <div class="row">
        <!-- Reservas -->
        <div class="col-sm-3 col-md-3">
            <a href="/Reserva/Index/" class="thumbnail">
                <h4 align="center" style="margin-bottom:0"><label class="control-label">Reservas</label></h4>
                <hr style="margin-top:0" />
                <div class="form-group">
                    <label class="control-label">Total de Reservas: </label>
                    <span style="color:black"><strong>@Model.TotalReservas</strong></span>
                </div>
                <div class="form-group">
                    <label class="control-label">Valor Arrecadado: </label>
                    <span style="color:black"><strong>@Model.ValorArrecadado.ToString("C")</strong></span>
                </div>
            </a>
        </div>

        <!-- Salas -->
        <div class="col-sm-3 col-md-3">
            <a href="/Sala/Index/" class="thumbnail">
                <h4 align="center" style="margin-bottom:0"><label class="control-label">Salas</label></h4>
                <hr style="margin-top:0" />
                <div class="form-group">
                    <label class="control-label">Salas Cadastradas: </label>
                    <span style="color:black"><strong>@Model.TotalSalas</strong></span>
                </div>
                <div class="form-group">
                    <label class="control-label">Sala Maior Capacidade: </label>
                    <span style="color:black"><strong>@Model.SalaMaiorCapacidade</strong></span>
                </div>
            </a>
        </div>

        <!-- Ultima Reserva -->
        <div class="col-sm-3 col-md-3">
            <a href="/Reserva/Details/@Model.UltimaReserva.Id" class="thumbnail">
                <h4 align="center" style="margin-bottom:0"><label class="control-label">Última Reserva</label></h4>
                <hr style="margin-top:0" />
                <div class="form-group">
                    <div class="panel-heading" style="padding:0">
                        <label class="control-label">Reserva:</label>
                    </div>
                    <div class="panel-body" style="padding:0;text-align:justify">
                        <span style="color:black">
                            <strong>
                                @string.Concat(Model.UltimaReserva.Sala.Nome,
                                                " - ",
                                                Model.UltimaReserva.Sala.CapacidadeMaxima, " Lugares ",
                                                " - ",
                                                Model.UltimaReserva.Sala.ValorHora.ToString("C"), "/h")
                            </strong>
                        </span>
                        <span style="color:black">
                            <strong>
                                @string.Concat(Model.UltimaReserva.DataHora, " - ", Model.UltimaReserva.HorasReservadas, "h")
                            </strong>
                        </span>
                    </div>
                </div>
            </a>
        </div>

        <!-- Ultima Sala Cadastrada -->
        <div class="col-sm-3 col-md-3">
            <a href="/Reserva/Details/@Model.UltimaSalaCadastrada.Id" class="thumbnail">
                <h4 align="center" style="margin-bottom:0"><label class="control-label">Última Sala Cadastrada</label></h4>
                <hr style="margin-top:0" />
                <div class="form-group">
                    <div class="panel-heading" style="padding:0">
                        <label class="control-label">Sala:</label>
                    </div>
                    <div class="panel-body" style="padding:0;text-align:justify">
                        <span style="color:black">
                            <strong>
                                @string.Concat(Model.UltimaSalaCadastrada.Nome,
                                                " - ",
                                                Model.UltimaSalaCadastrada.CapacidadeMaxima, " Lugares ",
                                                " - ",
                                                Model.UltimaSalaCadastrada.ValorHora.ToString("C"), "/h")
                            </strong>
                        </span>
                        <span style="color:black">
                            <strong>
                                @string.Concat(Model.UltimaSalaCadastrada.Endereco.Logradouro,
                                                " ",
                                                Model.UltimaSalaCadastrada.Endereco.Numero,
                                                " ",
                                                Model.UltimaSalaCadastrada.Endereco.Complemento)
                            </strong>
                        </span>
                    </div>
                </div>
            </a>
        </div>
    </div>

    <hr />

    <h3>Info-Gráfico: </h3>

    <div class="panel panel-default">
        <canvas id="myChart" max-width="50" max-height="50"></canvas>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0/dist/Chart.min.js"></script>
    <script>
        var ctx = document.getElementById('myChart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Salas', 'Reservas'],
                datasets: [{
                    label: 'Total',
                    data: [@Model.TotalSalas, @Model.TotalReservas],
                    backgroundColor: [
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                    ],
                    borderColor: [
                        'rgba(54, 162, 235, 1)',
                        'rgba(153, 102, 255, 1)',
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
    </script>
</div>